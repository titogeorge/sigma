name: application
applications: ""
definitions:
- name: audit_cve_event
  description: Detects events generated by Windows to indicate the exploitation of
    a known vulnerability (e.g. CVE-2020-0601)
  condition: ([Source] == ['Microsoft-Windows-Audit-CVE'])
  level: critical
  ruletype: EVALUATE
  tags: attack,execution,t1203,privilege_escalation,t1068,defense_evasion,t1211,credential_access,t1212,lateral_movement,t1210,impact,t1499,004
  exttype: SIEM
- name: microsoft_malware_protection_engine_crash
  description: This rule detects a suspicious crash of the Microsoft Malware Protection
    Engine
  condition: ([Source] == ['Application Error']) && ([EventID] == 1000) || ([Source]
    == ['Windows Error Reporting']) && ([EventID] == 1001) && message =~ 'MsMpEng.exe'
    || message =~ 'mpengine.dll'
  level: high
  ruletype: EVALUATE
  tags: attack,defense_evasion,t1089,t1211,t1562,001
  exttype: SIEM
- name: relevant_anti_virus_event
  description: This detection method points out highly relevant Antivirus events
  condition: message =~ 'HTool.*' || message =~ 'Hacktool' || message =~ 'ASP.*Backdoor'
    || message =~ 'JSP.*Backdoor' || message =~ 'PHP.*Backdoor' || message =~ 'Backdoor.ASP'
    || message =~ 'Backdoor.JSP' || message =~ 'Backdoor.PHP' || message =~ 'Webshell'
    || message =~ 'Portscan' || message =~ 'Mimikatz' || message =~ 'WinCred' || message
    =~ 'PlugX' || message =~ 'Korplug' || message =~ 'Pwdump' || message =~ 'Chopper'
    || message =~ 'WmiExec' || message =~ 'Xscan' || message =~ 'Clearlog' || message
    =~ 'ASPXSpy' && message !~ 'Keygen' || message !~ 'Crack'
  level: high
  ruletype: EVALUATE
  tags: ""
  exttype: SIEM
- name: cve_2020_0688_exploitation_via_eventlog
  description: Detects the exploitation of Microsoft Exchange vulnerability as described
    in CVE-2020-0688
  condition: ([EventID] == 4) && ([Source] == ['MSExchange Control Panel']) && ([Level]
    == ['Error']) && message =~ '.*.*.*VIEWSTATE='
  level: high
  ruletype: EVALUATE
  tags: attack,initial_access,t1190
  exttype: SIEM
- name: backup_catalog_deleted
  description: Detects backup catalog deletions
  condition: ([EventID] == 524) && ([Source] == ['Microsoft-Windows-Backup'])
  level: medium
  ruletype: EVALUATE
  tags: attack,defense_evasion,t1107,t1070,004
  exttype: SIEM
